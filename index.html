<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TARIFUL 2.0</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:sans-serif}
body{background:#1a110f;color:#efdbd5;overflow-x:hidden}

/* Home Screen */
#home{height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:15px}
.owner-text { font-size: 0.8rem; color: #8b442d; font-weight: bold; letter-spacing: 1px; text-transform: uppercase; margin-bottom: -10px; }
.main-title { color:#d0ffda; margin-bottom: 25px; font-size: 2.2rem; }

.menu{width:85%;max-width:400px;padding:20px;border:none;border-radius:18px;font-size:1.1rem;font-weight:bold;cursor:pointer;transition:0.3s}
.video{background:#2e4d3c;color:#d0ffda}
.calc{background:#8b442d;color:#ffdad0}

/* Sections */
.section{display:none;padding:15px;animation:fadeIn 0.4s}
@keyframes fadeIn {from{opacity:0} to{opacity:1}}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
.back{background:#352d2b;color:#fff;border:none;padding:8px 18px;border-radius:25px;cursor:pointer}

/* Media Player & Audio Toggle */
#playerBox{display:none;background:#000;border-radius:15px;overflow:hidden;margin-bottom:10px;position:relative}
video{width:100%;max-height:50vh;display:block;cursor:pointer}

.audio-toggle-container { display: flex; justify-content: flex-end; margin-bottom: 10px; }
.audio-toggle-box { background: #2a1f1d; padding: 8px 15px; border-radius: 20px; font-size: 0.8rem; display: flex; align-items: center; gap: 8px; border: 1px solid #553f38; }

.audio-mode video { height: 0; opacity: 0; }
.audio-visualizer { display: none; padding: 50px; text-align: center; background: #2a1f1d; color: #d0ffda; font-weight: bold; }
.audio-mode .audio-visualizer { display: block; }

/* Control System */
.controls{display:flex;justify-content:center;align-items:center;gap:12px;padding:15px;background:#2a1f1d}
.btn-ctrl{background:#352d2b;color:white;border:none;width:45px;height:45px;border-radius:50%;cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center}
.btn-stop{background:#8b442d}

/* Hidden Loop Button */
#loopBtn { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.6); color: white; border: none; padding: 5px 10px; border-radius: 15px; font-size: 0.7rem; display: none; cursor: pointer; z-index: 10; }

/* Calculator & History (No Changes) */
.calc-box{max-width:360px;margin:auto}
.screen{height:90px;font-size:2.2rem;text-align:right;padding:10px;background:#2a1f1d;border-radius:15px;margin-bottom:15px;overflow:hidden}
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.btn{height:60px;border:none;border-radius:50%;font-size:1.2rem;cursor:pointer}
.num{background:#352d2b;color:white}
.func{background:#553f38;color:white}
.ac{background:#8b442d;color:white}
.eq{background:#f7e3a0;color:#3e2e00;border-radius:30px}
.hist-btn-main{background:#8b442d;color:#fff;border:none;padding:8px 20px;border-radius:20px;font-weight:bold;cursor:pointer}
#historyPanel{display:none;margin-top:20px;max-width:360px;margin:auto;background:#2a1f1d;padding:15px;border-radius:15px}
.hist-item{padding:8px 0;border-bottom:1px solid #352d2b}

.video-item{padding:12px;background:#2a1f1d;border-radius:10px;margin-top:8px;cursor:pointer; font-size: 0.9rem}
</style>
</head>

<body>

<div id="home">
    <p class="owner-text">Owner by TARIFUL ISLAM</p>
    <h1 class="main-title">TARIFUL 2.0</h1>
    
    <button class="menu video" onclick="openSec('videoSec')">üé¨ Media Player</button>
    <button class="menu calc" onclick="openSec('calcSec')">üßÆ Calculator</button>
</div>

<div id="videoSec" class="section">
    <div class="header">
        <button class="back" onclick="goHome()">‚Üê Back</button>
        <h3 style="color:#d0ffda">Media Player</h3>
    </div>

    <div class="audio-toggle-container">
        <div class="audio-toggle-box">
            <span>Audio Mode</span>
            <input type="checkbox" id="audioToggle" onchange="toggleAudioMode()">
        </div>
    </div>

    <div id="playerBox">
        <button id="loopBtn" onclick="toggleLoop()">Loop: OFF</button>
        <div class="audio-visualizer">üéµ Playing in Background</div>
        <video id="mainMedia" playsinline onclick="showLoop()"></video>
        
        <div class="controls">
            <button class="btn-ctrl" onclick="prev()">‚èÆ</button>
            <button class="btn-ctrl" onclick="togglePlay()" id="pBtn">‚ñ∂</button>
            <button class="btn-ctrl" onclick="stopMedia()" class="btn-ctrl btn-stop">‚èπ</button>
            <button class="btn-ctrl" onclick="next()">‚è≠</button>
        </div>
    </div>

    <input type="file" id="fileInput" multiple accept="video/*,audio/*" onchange="handleFiles(event)" style="margin-bottom:15px">
    <div id="videoList"></div>
</div>

<div id="calcSec" class="section">
    <div class="header">
        <button class="back" onclick="goHome()">‚Üê Back</button>
        <button class="hist-btn-main" onclick="toggleHistory()">History üïí</button>
    </div>
    <div class="calc-box">
        <div class="screen" id="disp">0</div>
        <div class="grid">
            <button class="btn ac" onclick="clr()">AC</button>
            <button class="btn func" onclick="add('/')">√∑</button>
            <button class="btn func" onclick="add('*')">√ó</button>
            <button class="btn num" onclick="bk()">‚å´</button>
            <button class="btn num" onclick="add('7')">7</button>
            <button class="btn num" onclick="add('8')">8</button>
            <button class="btn num" onclick="add('9')">9</button>
            <button class="btn func" onclick="add('-')">‚àí</button>
            <button class="btn num" onclick="add('4')">4</button>
            <button class="btn num" onclick="add('5')">5</button>
            <button class="btn num" onclick="add('6')">6</button>
            <button class="btn func" onclick="add('+')">+</button>
            <button class="btn num" onclick="add('1')">1</button>
            <button class="btn num" onclick="add('2')">2</button>
            <button class="btn num" onclick="add('3')">3</button>
            <button class="btn eq" onclick="calc()">=</button>
            <button class="btn num" style="grid-column:span 2;border-radius:40px" onclick="add('0')">0</button>
            <button class="btn num" onclick="add('.')">.</button>
        </div>
    </div>
    <div id="historyPanel">
        <div style="display:flex;justify-content:space-between;margin-bottom:10px">
            <span>Saved History</span>
            <button onclick="clearHistory()" style="background:none;border:none;color:#ff8b8b;cursor:pointer">Clear</button>
        </div>
        <div id="histList"></div>
    </div>
</div>

<script>
const media = document.getElementById("mainMedia");
const loopBtn = document.getElementById("loopBtn");
let queue = [];
let currentIdx = 0;
let isLooping = false;

function openSec(id){
    document.getElementById("home").style.display="none";
    document.querySelectorAll(".section").forEach(s=>s.style.display="none");
    document.getElementById(id).style.display="block";
    if(id==='calcSec') renderHistory();
}
function goHome(){
    document.getElementById("home").style.display="flex";
    document.querySelectorAll(".section").forEach(s=>s.style.display="none");
}

function handleFiles(e) {
    queue = Array.from(e.target.files);
    renderList();
    play(0);
}
function renderList() {
    const list = document.getElementById("videoList");
    list.innerHTML = queue.map((f, i) => `<div class="video-item" onclick="play(${i})">${i+1}. ${f.name}</div>`).join('');
}
function play(index) {
    if (index < 0 || index >= queue.length) return;
    currentIdx = index;
    media.src = URL.createObjectURL(queue[index]);
    document.getElementById("playerBox").style.display = "block";
    media.play();
    document.getElementById("pBtn").innerText = "‚è∏";
}
function togglePlay() { media.paused ? (media.play(), document.getElementById("pBtn").innerText = "‚è∏") : (media.pause(), document.getElementById("pBtn").innerText = "‚ñ∂"); }
function stopMedia() { media.pause(); media.currentTime = 0; document.getElementById("pBtn").innerText = "‚ñ∂"; }
function next() { play(currentIdx + 1); }
function prev() { play(currentIdx - 1); }
function toggleAudioMode() { document.getElementById("playerBox").classList.toggle("audio-mode", document.getElementById("audioToggle").checked); }
function showLoop() { loopBtn.style.display = "block"; setTimeout(() => { if(!isLooping) loopBtn.style.display = "none"; }, 3000); }
function toggleLoop() {
    isLooping = !isLooping;
    media.loop = isLooping;
    loopBtn.innerText = isLooping ? "Loop: ON" : "Loop: OFF";
    loopBtn.style.background = isLooping ? "#2e4d3c" : "rgba(0,0,0,0.6)";
}
media.onended = () => { if(!isLooping) next(); };
document.addEventListener("visibilitychange", () => { if(document.hidden && !media.paused) media.play(); });

/* Calculator Logic (Preserved) */
function add(v){ let d=document.getElementById("disp"); d.innerText = d.innerText==="0" ? v : d.innerText+v; }
function clr(){ document.getElementById("disp").innerText="0"; }
function bk(){ let d=document.getElementById("disp"); d.innerText = d.innerText.length>1 ? d.innerText.slice(0,-1) : "0"; }
function calc(){
    let d=document.getElementById("disp");
    try {
        let res = eval(d.innerText.replace('√ó','*').replace('√∑','/').replace('‚àí','-'));
        saveHistory(`${d.innerText} = ${res}`);
        d.innerText = res;
    } catch { d.innerText = "Error"; }
}
function toggleHistory(){ let p = document.getElementById("historyPanel"); p.style.display = p.style.display==='block' ? 'none' : 'block'; }
function saveHistory(item){
    let h = JSON.parse(localStorage.getItem("calc_h") || "[]");
    h.unshift(item);
    localStorage.setItem("calc_h", JSON.stringify(h.slice(0,20)));
    renderHistory();
}
function renderHistory(){
    let h = JSON.parse(localStorage.getItem("calc_h") || "[]");
    document.getElementById("histList").innerHTML = h.map(i => `<div class="hist-item">${i}</div>`).join('');
}
function clearHistory(){ localStorage.removeItem("calc_h"); renderHistory(); }
</script>
</body>
</html>
