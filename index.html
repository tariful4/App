<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tariful Islam - QR & Calc Pro</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500&display=swap');

*{box-sizing:border-box;font-family:'Google Sans',sans-serif;margin:0;padding:0}
body{background:#1a110f;color:#efdbd5;min-height:100vh;display:flex;flex-direction:column;align-items:center}

/* Home */
#home-screen{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;gap:15px;width:100%}
.menu-btn{width:85%;max-width:400px;padding:30px;font-size:1.2rem;font-weight:bold;border:none;border-radius:20px}
.qr-menu{background:#553f38;color:#efdbd5}
.calc-menu{background:#8b442d;color:#ffdad0}

/* Sections */
.app-section{display:none;width:100%;flex-direction:column;align-items:center;padding:20px}
.header-row{width:100%;display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
.back-btn{background:#352d2b;color:#efdbd5;border:1px solid #553f38;padding:10px 20px;border-radius:50px}

/* QR Scanner FIX */
#scanner-container{
    width:100%;
    max-width:400px;
    height:300px;          /* üî• MAIN FIX */
    border-radius:15px;
    overflow:hidden;
    background:#000;
    border:2px solid #553f38;
}

.result-box{width:100%;max-width:400px;background:#2a1f1d;padding:15px;margin-top:15px;border-radius:15px;text-align:center}

/* Calculator */
.calculator{width:100%;max-width:360px}
.screen{height:120px;display:flex;justify-content:flex-end;align-items:flex-end;margin-bottom:20px}
.input-text{font-size:3rem}
.buttons-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.calc-btn{height:70px;width:70px;border-radius:50%;border:none;font-size:1.5rem}
.num-btn{background:#352d2b;color:#efdbd5}
.func-btn{background:#553f38;color:#efdbd5}
.ac-btn{background:#8b442d;color:#ffdad0}
.equal-btn{background:#f7e3a0;color:#3e2e00;border-radius:28px}
</style>
</head>

<body>

<div id="home-screen">
    <button class="menu-btn qr-menu" onclick="openApp('qr-section')">QR Code</button>
    <button class="menu-btn calc-menu" onclick="openApp('calc-section')">Calculator</button>
</div>

<!-- QR SECTION -->
<div id="qr-section" class="app-section">
    <div class="header-row">
        <button class="back-btn" onclick="goHome()">‚Üê Back</button>
        <button class="back-btn" onclick="openApp('scan-section')">Scan</button>
    </div>

    <input id="qrcode-input" placeholder="Enter text"
    oninput="generateQR()"
    style="padding:15px;width:90%;border-radius:12px;background:#2a1f1d;color:white">

    <div id="qrcode-display" style="margin-top:15px;background:white;padding:10px;border-radius:15px"></div>
</div>

<!-- SCAN SECTION -->
<div id="scan-section" class="app-section">
    <div class="header-row">
        <button class="back-btn" onclick="openApp('qr-section')">‚Üê Back</button>
        <b>QR Scanner</b>
    </div>

    <div id="scanner-container"></div>

    <div class="result-box">
        <p id="scan-result">Waiting for scan...</p>
    </div>
</div>

<!-- CALC -->
<div id="calc-section" class="app-section">
    <button class="back-btn" onclick="goHome()">‚Üê Back</button>
    <div class="calculator">
        <div class="screen"><div id="display" class="input-text">0</div></div>
        <div class="buttons-grid">
            <button class="calc-btn ac-btn" onclick="clearAll()">AC</button>
            <button class="calc-btn func-btn" onclick="append('/')">√∑</button>
            <button class="calc-btn func-btn" onclick="append('*')">√ó</button>
            <button class="calc-btn num-btn" onclick="backspace()">‚å´</button>
            <button class="calc-btn num-btn" onclick="append('7')">7</button>
            <button class="calc-btn num-btn" onclick="append('8')">8</button>
            <button class="calc-btn num-btn" onclick="append('9')">9</button>
            <button class="calc-btn func-btn" onclick="append('-')">-</button>
            <button class="calc-btn num-btn" onclick="append('4')">4</button>
            <button class="calc-btn num-btn" onclick="append('5')">5</button>
            <button class="calc-btn num-btn" onclick="append('6')">6</button>
            <button class="calc-btn func-btn" onclick="append('+')">+</button>
            <button class="calc-btn num-btn" onclick="append('1')">1</button>
            <button class="calc-btn num-btn" onclick="append('2')">2</button>
            <button class="calc-btn num-btn" onclick="append('3')">3</button>
            <button class="calc-btn equal-btn" onclick="calculate()">=</button>
            <button class="calc-btn num-btn" style="grid-column:span 2;width:155px;border-radius:40px" onclick="append('0')">0</button>
            <button class="calc-btn num-btn" onclick="append('.')">.</button>
        </div>
    </div>
</div>

<script>
let html5QrCode=null;

function openApp(id){
    document.getElementById('home-screen').style.display='none';
    document.querySelectorAll('.app-section').forEach(s=>s.style.display='none');
    document.getElementById(id).style.display='flex';
    if(id==='scan-section') startScanner();
    else stopScanner();
}
function goHome(){
    stopScanner();
    document.getElementById('home-screen').style.display='flex';
    document.querySelectorAll('.app-section').forEach(s=>s.style.display='none');
}

/* QR */
const qr=new QRCode(document.getElementById("qrcode-display"),{width:200,height:200});
function generateQR(){
    const v=qrcode-input.value.trim();
    if(v) qr.makeCode(v);
}

/* SCANNER FIXED */
function startScanner(){
    if(html5QrCode && html5QrCode.isScanning) return;
    html5QrCode=new Html5Qrcode("scanner-container");
    html5QrCode.start(
        {facingMode:"environment"},
        {fps:10,qrbox:250},
        txt=>document.getElementById('scan-result').innerText=txt
    ).catch(e=>{
        document.getElementById('scan-result').innerText="Camera error";
        console.error(e);
    });
}
function stopScanner(){
    if(html5QrCode && html5QrCode.isScanning) html5QrCode.stop();
}

/* CALC */
const d=document.getElementById("display");
function append(v){d.innerText=d.innerText==="0"?v:d.innerText+v}
function clearAll(){d.innerText="0"}
function backspace(){d.innerText=d.innerText.length>1?d.innerText.slice(0,-1):"0"}
function calculate(){try{d.innerText=eval(d.innerText)}catch{d.innerText="Error"}}
</script>

</body>
</html>
